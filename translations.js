const translations = {
    "en": {
        "title_login": "e-Municipal Services - Login",
        "header_main": "e-Municipal Services",
        "tagline": "Fast • Transparent • Digital",
        "role_citizen": "Citizen",
        "role_officer": "Officer",
        "placeholder_mobile": "Mobile Number",
        "placeholder_username": "Username",
        "placeholder_password": "Password",
        "btn_login": "LOGIN",
        "link_forgot": "Forgot Password?",
        "text_or": "OR",
        "btn_register_new": "REGISTER NEW USER",
        "footer_powered": "Powered by Digital Municipality Initiative",

        "title_register": "Register - e-Municipal Services",
        "header_register": "New User Registration",
        "placeholder_fullname": "Full Name",
        "placeholder_email": "Email (Optional)",
        "placeholder_confirm_pass": "Confirm Password",
        "btn_register": "REGISTER",
        "link_back_login": "Back to Login",

        "title_dashboard": "Dashboard - e-Municipal Services",
        "header_citizen_dashboard": "Citizen Dashboard",
        "card_birth": "Apply Birth Certificate",
        "card_death": "Apply Death Certificate",
        "card_property": "Pay Property Tax",
        "card_water": "Pay Water Tax",
        "card_track": "Track Application",
        "card_download": "Download Certificate",
        "card_grievance": "Lodge Grievance",
        "card_my_apps": "My Applications",

        "title_birth": "Birth Certificate Application",
        "header_birth": "Apply Birth Certificate",
        "label_child_name": "Child Name",
        "label_dob": "Date of Birth",
        "label_pob": "Place of Birth",
        "label_father_name": "Father's Name",
        "label_mother_name": "Mother's Name",
        "label_proof_birth": "Proof of Birth (Hospital Record)",
        "btn_submit_app": "Submit Application",
        "link_back_dashboard": "Back to Dashboard",

        "title_death": "Death Certificate Application",
        "header_death": "Apply Death Certificate",
        "label_deceased_name": "Deceased Name",
        "label_dod": "Date of Death",
        "label_pod": "Place of Death",
        "label_cause": "Cause of Death",
        "label_proof_death": "Proof of Death (Doctor's Certificate)",

        "title_track": "Track Application",
        "header_track": "Track Application",
        "placeholder_app_id": "Enter Application ID",
        "btn_track_status": "Track Status",
        "label_app_id": "Application ID:",
        "label_type": "Type:",
        "label_date": "Date:",
        "label_status": "Status:",
        "label_remark": "Officer Remark:",
        "btn_download_cert": "Download Certificate",
        "btn_view_response": "View Officer Response",

        "title_my_apps": "My Applications",
        "header_my_apps": "My Applications",
        "msg_no_apps": "No applications found.",

        "title_grievance": "Lodge Grievance",
        "header_grievance": "Lodge Grievance",
        "label_complainant_name": "Complainant Name",
        "label_department": "Department",
        "option_select_dept": "Select Department",
        "opt_roads": "Roads",
        "opt_garbage": "Garbage/Sanitation",
        "opt_water": "Water Supply",
        "opt_electricity": "Street Lights/Electricity",
        "opt_other": "Other",
        "label_description": "Complaint Description",
        "label_address": "Location/Address",
        "label_photo": "Upload Photo (Optional)",
        "btn_submit_grievance": "Lodge Grievance",

        "title_officer_login": "Officer Login",
        "header_officer_login": "Officer Portal Login",
        "btn_officer_login": "LOGIN AS OFFICER",
        "link_citizen_login": "Citizen Login",

        "title_officer_dashboard": "Officer Dashboard",
        "header_officer_dashboard": "Officer Dashboard",
        "link_logout": "Logout",
        "th_app_id": "App ID",
        "th_type": "Type",
        "th_date": "Date",
        "th_status": "Status",
        "th_action": "Action",
        "btn_view": "View",
        "header_app_details": "Application Details",
        "label_applicant_doc": "Applicant Document",
        "link_view_doc": "View Uploaded Document",
        "header_update_status": "Update Status",
        "placeholder_remarks": "Enter remarks (required for Rejection/Clarification)",
        "label_upload_cert": "Upload Generated Certificate (PDF/Image):",
        "btn_reject": "Reject",
        "btn_clarify": "Req. Clarification",
        "btn_approve": "Approve",
        "btn_confirm_approve": "Confirm Approval & Upload",
        "btn_close": "Close",

        "msg_login_success": "Login Successful",
        "msg_invalid_creds": "Invalid Credentials",
        "msg_server_error": "Server Error",
        "msg_fill_all": "Please fill all required fields",
        "msg_pass_mismatch": "Passwords do not match",
        "msg_reg_success": "Registration Successful!",
        "msg_app_submitted": "Application Submitted Successfully! Application ID: ",
        "msg_enter_app_id": "Please enter Application ID",
        "msg_app_not_found": "Application not found",
        "msg_enter_remark": "Please enter a remark for this action.",
        "msg_grievance_submitted": "Grievance Lodged Successfully! Application ID: ",
        "msg_upload_cert": "Please upload the certificate file.",
        "msg_status_updated": "Status Updated!",

        "title_forgot": "Forgot Password - e-Municipal Services",
        "header_forgot": "Reset Password",
        "btn_send_otp": "Send OTP",
        "label_otp": "Enter OTP",
        "placeholder_otp": "4-digit OTP",
        "placeholder_new_pass": "New Password",
        "btn_verify_reset": "Verify & Reset Password",
        "msg_otp_sent": "OTP Sent Successfully! (Demo: Check Console or Alert)",
        "msg_pass_reset_success": "Password Reset Successfully! Please Login.",
        "msg_invalid_otp": "Invalid OTP"
    },
    "mr": {
        "title_login": "ई-नगरपालिका सेवा - लॉगिन",
        "header_main": "ई-नगरपालिका सेवा",
        "tagline": "जलद • पारदर्शक • डिजिटल",
        "role_citizen": "नागरिक",
        "role_officer": "अधिकारी",
        "placeholder_mobile": "मोबाईल क्रमांक",
        "placeholder_username": "वापरकर्ता नाव",
        "placeholder_password": "पासवर्ड",
        "btn_login": "लॉगिन",
        "link_forgot": "पासवर्ड विसरलात?",
        "text_or": "किंवा",
        "btn_register_new": "नवीन नोंदणी करा",
        "footer_powered": "डिजिटल नगरपालिका उपक्रमाद्वारे समर्थित",

        "title_register": "नोंदणी - ई-नगरपालिका सेवा",
        "header_register": "नवीन वापरकर्ता नोंदणी",
        "placeholder_fullname": "पूर्ण नाव",
        "placeholder_email": "ईमेल (पर्यायी)",
        "placeholder_confirm_pass": "पासवर्डची पुष्टी करा",
        "btn_register": "नोंदणी करा",
        "link_back_login": "लॉगिनकडे परत",

        "title_dashboard": "डॅशबोर्ड - ई-नगरपालिका सेवा",
        "header_citizen_dashboard": "नागरिक डॅशबोर्ड",
        "card_birth": "जन्म प्रमाणपत्रासाठी अर्ज करा",
        "card_death": "मृत्यू प्रमाणपत्रासाठी अर्ज करा",
        "card_property": "मालमत्ता कर भरा",
        "card_water": "पाणीपट्टी भरा",
        "card_track": "अर्जाची स्थिती पहा",
        "card_download": "प्रमाणपत्र डाउनलोड करा",
        "card_grievance": "तक्रार नोंदवा",
        "card_my_apps": "माझे अर्ज",

        "title_birth": "जन्म दाखला अर्ज",
        "header_birth": "जन्म दाखल्यासाठी अर्ज",
        "label_child_name": "मुलाचे नाव",
        "label_dob": "जन्मतारीख",
        "label_pob": "जन्म ठिकाण",
        "label_father_name": "वडिलांचे नाव",
        "label_mother_name": "आईचे नाव",
        "label_proof_birth": "जन्माचा पुरावा (रुग्णालय नोंद)",
        "btn_submit_app": "अर्ज सादर करा",
        "link_back_dashboard": "डॅशबोर्डवर परत जा",

        "title_death": "मृत्यू दाखला अर्ज",
        "header_death": "मृत्यू दाखल्यासाठी अर्ज",
        "label_deceased_name": "मृताचे नाव",
        "label_dod": "मृत्यू दिनांक",
        "label_pod": "मृत्यूचे ठिकाण",
        "label_cause": "मृत्यूचे कारण",
        "label_proof_death": "मृत्यूचा पुरावा (डॉक्टरांचे प्रमाणपत्र)",

        "title_track": "अर्जाची स्थिती",
        "header_track": "अर्जाची स्थिती",
        "placeholder_app_id": "अर्ज क्रमांक प्रविष्ट करा",
        "btn_track_status": "स्थिती पहा",
        "label_app_id": "अर्ज क्रमांक:",
        "label_type": "प्रकार:",
        "label_date": "तारीख:",
        "label_status": "स्थिती:",
        "label_remark": "अधिकारी टिप्पणी:",
        "btn_download_cert": "प्रमाणपत्र डाउनलोड करा",
        "btn_view_response": "अधिकारी प्रतिसाद पहा",

        "title_my_apps": "माझे अर्ज",
        "header_my_apps": "माझे अर्ज",
        "msg_no_apps": "कोणतेही अर्ज सापडले नाहीत.",

        "title_grievance": "तक्रार नोंदवा",
        "header_grievance": "तक्रार नोंदवा",
        "label_complainant_name": "तक्रारदाराचे नाव",
        "label_department": "विभाग",
        "option_select_dept": "विभाग निवडा",
        "opt_roads": "रस्ते",
        "opt_garbage": "कचरा/स्वच्छता",
        "opt_water": "पाणी पुरवठा",
        "opt_electricity": "पथदिवे/वीज",
        "opt_other": "इतर",
        "label_description": "तक्रारीचे वर्णन",
        "label_address": "ठिकाण/पत्ता",
        "label_photo": "फोटो अपलोड करा (वैकल्पिक)",
        "btn_submit_grievance": "तक्रार नोंदवा",

        "title_officer_login": "अधिकारी लॉगिन",
        "header_officer_login": "अधिकारी पोर्टल लॉगिन",
        "btn_officer_login": "अधिकारी लॉगिन",
        "link_citizen_login": "नागरिक लॉगिन",

        "title_officer_dashboard": "अधिकारी डॅशबोर्ड",
        "header_officer_dashboard": "अधिकारी डॅशबोर्ड",
        "link_logout": "बाहेर पडा",
        "th_app_id": "अर्ज क्र.",
        "th_type": "प्रकार",
        "th_date": "तारीख",
        "th_status": "स्थिती",
        "th_action": "क्रिया",
        "btn_view": "पहा",
        "header_app_details": "अर्जाचा तपशील",
        "label_applicant_doc": "अर्जदाराचे कागदपत्र",
        "link_view_doc": "अपलोड केलेले कागदपत्र पहा",
        "header_update_status": "स्थिती अपडेट करा",
        "placeholder_remarks": "टिप्पणी प्रविष्ट करा (नाकारणे/स्पष्टीकरणासाठी आवश्यक)",
        "label_upload_cert": "तयार केलेले प्रमाणपत्र अपलोड करा (PDF/Image):",
        "btn_reject": "नाकारा",
        "btn_clarify": "स्पष्टीकरण मागा",
        "btn_approve": "मंजूर करा",
        "btn_confirm_approve": "मंजूरीची पुष्टी करा आणि अपलोड करा",
        "btn_close": "बंद करा",

        "msg_login_success": "लॉगिन यशस्वी",
        "msg_invalid_creds": "अवैध ओळखपत्रे",
        "msg_server_error": "सर्व्हर त्रुटी",
        "msg_fill_all": "कृपया सर्व आवश्यक फील्ड भरा",
        "msg_pass_mismatch": "पासवर्ड जुळत नाहीत",
        "msg_reg_success": "नोंदणी यशस्वी!",
        "msg_app_submitted": "अर्ज यशस्वीरित्या सादर केला! अर्ज क्रमांक: ",
        "msg_enter_app_id": "कृपया अर्ज क्रमांक प्रविष्ट करा",
        "msg_app_not_found": "अर्ज सापडला नाही",
        "msg_enter_remark": "कृपया या क्रियेसाठी टिप्पणी प्रविष्ट करा.",
        "msg_grievance_submitted": "तक्रार यशस्वीरित्या नोंदवली! अर्ज क्रमांक: ",
        "msg_upload_cert": "कृपया प्रमाणपत्र फाइल अपलोड करा.",
        "msg_status_updated": "स्थिती अपडेट केली!",

        "title_forgot": "पासवर्ड विसरलात - ई-नगरपालिका सेवा",
        "header_forgot": "पासवर्ड रीसेट करा",
        "btn_send_otp": "OTP पाठवा",
        "label_otp": "OTP प्रविष्ट करा",
        "placeholder_otp": "4-अंकी OTP",
        "placeholder_new_pass": "नवीन पासवर्ड",
        "btn_verify_reset": "पडताळणी करा आणि पासवर्ड बदला",
        "msg_otp_sent": "OTP यशस्वीरित्या पाठविला! (डेमो: कन्सोल किंवा सूचना तपासा)",
        "msg_pass_reset_success": "पासवर्ड यशस्वीरित्या बदलला! कृपया लॉगिन करा.",
        "msg_invalid_otp": "अवैध OTP"
    }
};

function setLanguage(lang) {
    localStorage.setItem('appLang', lang);

    // Update all elements with data-i18n attribute
    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (translations[lang][key]) {
            if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
                el.placeholder = translations[lang][key];
            } else {
                el.innerText = translations[lang][key];
            }
        }
    });

    // Update Page Title if exists
    if (translations[lang]['title_' + document.body.dataset.page]) {
        document.title = translations[lang]['title_' + document.body.dataset.page];
    }
}

function getTranslation(key) {
    const lang = localStorage.getItem('appLang') || 'en';
    return translations[lang][key] || key;
}


// Auto-load saved language on startup
document.addEventListener('DOMContentLoaded', () => {
    const savedLang = localStorage.getItem('appLang') || 'en';
    setLanguage(savedLang);

    // Create Language Toggle Button if not exists
    if (!document.getElementById('langToggle')) {
        const btn = document.createElement('button');
        btn.id = 'langToggle';
        btn.innerText = savedLang === 'en' ? 'मराठी' : 'English';
        btn.style.cursor = 'pointer';

        // Check for header-right container for inline placement
        const headerRight = document.querySelector('.header-right');

        if (headerRight) {
            // Inline Styles for coupling with Logout
            btn.style.background = 'transparent';
            btn.style.border = '1px solid rgba(255,255,255,0.5)';
            btn.style.color = '#fff';
            btn.style.padding = '5px 10px';
            btn.style.borderRadius = '4px';
            btn.style.marginRight = '10px';
            btn.style.fontSize = '14px';

            // Insert before the logout button/link
            headerRight.insertBefore(btn, headerRight.firstChild);
        } else {
            // Fixed Position Fallback (for pages without header-right)
            btn.style.position = 'fixed';
            btn.style.top = '20px';
            btn.style.right = '20px';
            btn.style.padding = '8px 12px';
            btn.style.background = '#333';
            btn.style.color = '#fff';
            btn.style.border = 'none';
            btn.style.borderRadius = '5px';
            btn.style.width = "auto";
            btn.style.zIndex = '1000';
            btn.style.fontSize = '14px';
            document.body.appendChild(btn);
        }

        btn.onclick = () => {
            const current = localStorage.getItem('appLang') || 'en';
            const newLang = current === 'en' ? 'mr' : 'en';
            setLanguage(newLang);
            btn.innerText = newLang === 'en' ? 'मराठी' : 'English';
        };
    }
});
